<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BinGo Dashboard</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2e7d32; /* Deep green */
            --secondary: #388e3c; /* Medium green */
            --accent: #7cb342; /* Light green */
            --danger: #d32f2f; /* Red for alerts */
            --warning: #ffa000; /* Amber for warnings */
            --light: #f1f8e9; /* Very light green */
            --dark: #1b5e20; /* Dark green */
            --text: #2e3a3d; /* Dark gray-green */
            --gray: #78909c; /* Cool gray */
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #f1f8e9 0%, #e8f5e9 100%);
            min-height: 100vh;
            padding: 2rem;
            color: var(--text);
            position: relative; /* Needed for fixed button */
            padding-bottom: 80px; /* Space for floating button */
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        h1 {
            color: var(--dark);
            text-align: center;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
        }
        
        .bin-card {
            background: white;
            padding: 1.5rem;
            border-radius: 16px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            margin-bottom: 1.5rem;
            transition: transform 0.3s, box-shadow 0.3s;
            border-left: 4px solid var(--accent);
        }
        
        .bin-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .bin-id {
            font-weight: 600;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        .location {
            color: var(--gray);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin: 0.75rem 0;
        }
        
        .trash-level {
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .view-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 1rem;
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s;
        }
        
        .view-link:hover {
            color: var(--dark);
        }
        
        .loading-container {
            text-align: center;
            margin: 2rem 0;
        }
        
        .loading-spinner {
            border: 4px solid rgba(46, 125, 50, 0.1);
            border-radius: 50%;
            border-top: 4px solid var(--primary);
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        .error {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            text-align: center;
            color: var(--danger);
            margin-bottom: 1.5rem;
        }
        
        .error button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.5rem 1.5rem;
            border-radius: 8px;
            margin-top: 1rem;
            cursor: pointer;
            font-family: inherit;
            font-weight: 500;
            transition: background 0.2s;
        }
        
        .error button:hover {
            background: var(--dark);
        }
        
        .last-updated {
            color: var(--gray);
            font-size: 0.85rem;
            text-align: right;
            margin-top: 1.5rem;
            font-style: italic;
        }
        
        /* Floating History Button */
        .floating-history-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 12px 20px;
            box-shadow: 0 4px 12px rgba(46, 125, 50, 0.3);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: 'Poppins', sans-serif;
            font-size: 0.9rem;
            font-weight: 500;
            z-index: 100;
            transition: all 0.3s ease;
            text-decoration: none;
        }
        
        .floating-history-btn:hover {
            background: var(--dark);
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(46, 125, 50, 0.4);
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @media (max-width: 768px) {
            body {
                padding: 1rem;
            }
            
            .bin-card {
                padding: 1.25rem;
            }
            
            .floating-history-btn {
                bottom: 15px;
                right: 15px;
                padding: 10px 16px;
                font-size: 0.85rem;
            }
        }
    </style>
</head>
<body>
    
    <div class="fun-fact-bar">
      <div class="fun-fact-content">
        <i class="fas fa-recycle pulse"></i>
        <span id="trash-fact">Did you know? <span id="fact-text">Loading fascinating fact...</span></span>
        <button class="next-fact-btn" title="Next fact">
          <i class="fas fa-arrow-right"></i>
        </button>
      </div>
    </div>

    <style>
      .fun-fact-bar {
        padding: 1rem;
        margin-bottom: 1.5rem;
        border-radius: 8px;
      }
      
      .fun-fact-content {
        max-width: 900px;
        margin: 0 auto;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
      }
      
      #trash-fact {
        color: #2e7d32; /* Matching your bin green color */
        font-weight: 500;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 6px;
      }
      
      #fact-text {
        font-weight: 400;
        color: #2e7d32; /* Matching your bin green color */
      }
      
      .pulse {
        color: #2e7d32; /* Matching your bin green color */
        font-size: 1.2rem;
        animation: pulse 2s infinite;
      }
      
      .next-fact-btn {
        background: none;
        border: none;
        color: #2e7d32; /* Matching your bin green color */
        cursor: pointer;
        padding: 0.3rem;
        border-radius: 50%;
        transition: all 0.3s;
      }
      
      .next-fact-btn:hover {
        background: rgba(46, 125, 50, 0.1);
        transform: scale(1.1);
      }
      
      @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.1); }
        100% { transform: scale(1); }
      }
      
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(5px); }
        to { opacity: 1; transform: translateY(0); }
      }
      
      .fact-transition {
        animation: fadeIn 0.7s ease-out;
      }

      @media (max-width: 768px) {
        .fun-fact-content {
          flex-direction: column;
          gap: 8px;
        }
        
        #trash-fact {
          flex-direction: column;
          font-size: 0.85rem;
        }
        
        .next-fact-btn {
          margin-top: 0.5rem;
        }
      }
    </style>

    <script>
      // Expanded to 150+ facts organized by category
      const recyclingFacts = {
        general: [
          "üåé The world produces over 2.1 billion tons of waste annually - equivalent to 7,000 Empire State Buildings",
          "‚ôªÔ∏è Recycling one ton of mixed paper saves 165 trees and 7,000 gallons of water",
          "‚è≥ A single plastic bottle can take 450 years to decompose in landfills",
          "üìà If all Americans recycled just 10% more paper, we'd save 5 million trees per year",
          "üèôÔ∏è New Yorkers throw away enough trash daily to fill the Empire State Building",
          "üå≥ Recycling one ton of cardboard saves 46 gallons of oil",
          "üíß Producing recycled paper uses 60% less water than virgin paper production",
          "‚ö° Recycling aluminum saves 95% of the energy needed to make new aluminum",
          "üî• Incinerating 10,000 tons of waste creates 1 job, while recycling creates 10 jobs",
          "üè≠ The recycling industry generates $117 billion in economic activity annually"
        ],
        
        plastic: [
          "üîÑ Only 9% of the 9.2 billion tons of plastic ever produced has been recycled",
          "üåä Every minute, a garbage truck's worth of plastic enters our oceans",
          "üëï It takes about 25 recycled PET bottles to make one polyester fleece jacket",
          "üõë Microplastics have been found in 83% of tap water samples worldwide",
          "üîÑ The plastic recycling symbol (‚ôπ) was created in 1988 but doesn't guarantee recyclability",
          "üß¥ Plastic shampoo bottles take 500+ years to decompose in landfills",
          "ü•§ The world uses 1 million plastic bottles per minute - 91% aren't recycled",
          "üõçÔ∏è Americans use 100 billion plastic bags annually - recycling just 1% of them",
          "üçΩÔ∏è Plastic cutlery is among the top 10 most common beach litter items",
          "üß© Less than 1% of polystyrene (Styrofoam) is recycled due to processing costs"
        ],
        
        paper: [
          "üìú The first recorded paper recycling occurred in Japan in 1031 AD",
          "üì¶ Corrugated cardboard has an 89% US recycling rate - the highest of any material",
          "üì® The average American receives 41 pounds of junk mail yearly - most unrecycled",
          "üå≥ Recycling 1 ton of newspaper saves about 15 trees and 7,000 gallons of water",
          "üíß Paper mills using recycled content produce 35% less water pollution",
          "üìö Recycling all US newspapers could save 250 million trees annually",
          "üìä Office paper can be recycled 5-7 times before fibers become too short",
          "‚òï Wax-coated paper cups aren't recyclable in most facilities - 16 billion are used yearly",
          "üóûÔ∏è Newspaper takes about 6 weeks to decompose in nature (vs. 2-5 months for cardboard)",
          "üìù The first US newspaper printed on recycled paper was the Boston Globe in 1874"
        ],
        
        metal: [
          "üîò Aluminum can be recycled infinitely without quality loss - 75% of all aluminum ever made is still in use",
          "‚ö° Recycling one aluminum can saves enough energy to power a TV for 3 hours",
          "üöó Modern cars contain about 25% recycled steel - the most recycled material by weight",
          "‚è±Ô∏è An aluminum can be recycled and back on store shelves in as little as 60 days",
          "üí∞ Recycled aluminum is worth $1,500+ per ton - making it highly valuable",
          "üèóÔ∏è The Statue of Liberty contains 179,000 pounds of recycled copper",
          "üîå Copper wiring from electronics is 99.9% pure - making it ideal for recycling",
          "üîÑ Steel recycling saves enough energy annually to power 18 million homes",
          "‚öôÔ∏è Recycling one ton of steel conserves 2,500 pounds of iron ore and 1,400 pounds of coal",
          "üíç Gold from one ton of recycled circuit boards exceeds that from 17 tons of gold ore"
        ],
        
        ewaste: [
          "üì± Americans replace their cell phones every 18 months - recycling just 15% of them",
          "üíª Recycling one million laptops saves energy equivalent to 3,500 homes' annual use",
          "üñ•Ô∏è Only 12.5% of the 57 million tons of annual e-waste is properly recycled",
          "üîã Lithium-ion battery recycling could grow 10x by 2030 due to EV demand",
          "üéÆ Vintage gaming consoles contain gold worth recycling - some NES cartridges have $30 in gold",
          "üì∫ CRT TVs contain 4-8 pounds of lead - requiring special recycling",
          "üíæ Hard drives contain platinum and rare earth metals - 2 million tons are discarded yearly",
          "üñ®Ô∏è Printer cartridges take 450-1,000 years to decompose - but 70% are recyclable",
          "üîå Americans throw away $60 million in gold/silver from electronics annually",
          "üîÑ Proper e-waste recycling prevents heavy metals from leaching into groundwater"
        ],
        
        foodWaste: [
          "üçå 45% of all fruits/vegetables are wasted globally - the highest of any food group",
          "üóëÔ∏è US food waste could fill 730 football stadiums yearly - 40% of all food produced",
          "üí® Food waste emits 8% of global greenhouse gases - 3x aviation's impact",
          "üîÑ Composting food waste reduces methane emissions by 95% compared to landfills",
          "ü•ï Carrot tops can be regrown from scraps - reducing kitchen waste",
          "üçé The average American family wastes $1,800 worth of food annually",
          "ü•¨ Lettuce is the most wasted vegetable - 55% never gets eaten",
          "üçû Bread is the most wasted household food item - 32% is thrown away",
          "‚òï Used coffee grounds make excellent natural deodorizers and garden fertilizer",
          "ü•ö Eggshells add valuable calcium to compost and deter garden pests"
        ],
        
        innovations: [
          "üß™ Chemical recycling can break plastics down to molecular level for infinite reuse",
          "ü¶† Fungi-based packaging decomposes in 45 days - being tested by IKEA",
          "üõ∞Ô∏è Companies like Orbit Fab are developing space junk recycling technology",
          "üëü Adidas has made 11 million shoes from recycled ocean plastic since 2015",
          "üèóÔ∏è Recycled concrete can be 30% stronger than conventional concrete",
          "üß± Plastic waste is being turned into construction bricks stronger than concrete",
          "üß¥ Loop by TerraCycle delivers products in reusable containers collected for cleaning/refilling",
          "üçΩÔ∏è Notpla creates edible seaweed packaging that decomposes in weeks",
          "ü§ñ AMP Robotics uses AI-powered robots that sort recyclables 60x faster than humans",
          "‚ôªÔ∏è Chemical process converts mixed plastic waste into virgin-quality plastic"
        ],
        
        worldRecords: [
          "üèÜ Denmark recycles 89% of plastic bottles via a 3¬¢ deposit return system",
          "üåè Taiwan reduced landfill use from 70% to 5% in 20 years through strict recycling laws",
          "üá∏üá™ Sweden imports 2.3 million tons of trash yearly to fuel waste-to-energy plants",
          "üá∞üá∑ South Korea recycles 95% of food waste via mandatory composting since 2013",
          "üá®üá≠ Switzerland charges $5 per trash bag - leading to 52% recycling rate",
          "üá©üá™ Germany recycles 68% of waste - highest in EU through 'Green Dot' system",
          "üá≥üá¥ Norway recycles 97% of plastic bottles via reverse vending machines",
          "üáßüá™ Belgium recycles 87% of its packaging waste - 2nd highest in Europe",
          "üá¶üáπ Austria recycles 63% of municipal waste through door-to-door collection",
          "üá∏üáÆ Slovenia increased recycling from 22% to 60% in just 10 years"
        ],
        
        unusual: [
          "üö¨ Cigarette butts can be recycled into plastic pellets - 4.5 trillion are littered yearly",
          "üíá Human hair absorbs oil spills (1kg hair = 8kg oil) - used in cleanup booms",
          "üëñ Old jeans become UltraTouch insulation - 300 pairs insulate an average home",
          "üç∑ 13 billion wine corks are produced yearly - many recycled into flooring",
          "üçå Banana fibers make durable paper and textiles - 100 tons of stems wasted annually",
          "ü¶∑ Recycled dentures provide gold for electronics and jewelry",
          "üéª Used instrument strings become jewelry - 1.5 million violin strings discarded yearly",
          "üé£ Fishing nets become skateboards - 640,000 tons of 'ghost gear' enter oceans yearly",
          "üöó Recycled tires become playground surfaces - 300 million discarded annually",
          "üé® Crayola's ColorCycle program has recycled 100+ million markers into energy"
        ],
        
        history: [
          "üèõÔ∏è Ancient Romans recycled broken amphorae into concrete for roads (200 BC)",
          "üìú Japan's first paper recycling began in 1031 AD using old documents and rags",
          "‚öì WWII saw massive scrap metal drives - 33% of US war materials came from recycling",
          "üîÑ The modern recycling symbol (‚ôªÔ∏è) was created by Gary Anderson in 1970 for a contest",
          "üì¶ Cardboard box recycling began in 1890 when manufacturers reused shipping containers",
          "ü•´ The first aluminum can recycling program started in 1968 in Oregon",
          "üîã Lead-acid car batteries have been recycled since 1924 - current 99% recycling rate",
          "üì∫ The first e-waste recycling laws began in 1991 with Switzerland's ordinance",
          "üç∂ Japan's meticulous recycling culture developed after 2000 when landfill space ran out",
          "üîÑ The 'Blue Box' curbside recycling program debuted in 1981 in Canada"
        ],
        
        future: [
          "üß™ Enzymatic recycling can break down plastics in days instead of centuries",
          "üîÑ Chemical process converts mixed plastic waste into virgin-quality plastic",
          "üå± Algae-based bioplastics decompose in months and don't require farmland",
          "ü§ñ AI-powered smart bins automatically sort recyclables with 95% accuracy",
          "üèôÔ∏è 'Urban mining' will recover metals from buildings and infrastructure",
          "üõ∞Ô∏è Space-based recycling could process waste in zero-gravity environments",
          "üß¨ Genetically engineered bacteria may break down plastics naturally",
          "üíß Waterless recycling processes could save billions of gallons annually",
          "üè≠ 'Closed-loop' manufacturing aims for 100% material reuse",
          "üåé Global recycling rates could reach 75% by 2050 with current innovations"
        ]
      };

      // Combine all categories into one array
      const allFacts = Object.values(recyclingFacts).flat();

      function showRandomFact() {
        const factElement = document.getElementById('fact-text');
        const container = document.getElementById('trash-fact');
        
        // Fade out
        factElement.style.transition = 'opacity 0.3s ease';
        factElement.style.opacity = 0;
        
        setTimeout(() => {
          // Get random fact with emoji
          const randomFact = allFacts[Math.floor(Math.random() * allFacts.length)];
          
          // Update text
          factElement.textContent = randomFact;
          
          // Add animation class
          factElement.classList.add('fact-transition');
          
          // Fade in
          factElement.style.opacity = 1;
          
          // Remove animation class after it completes
          setTimeout(() => {
            factElement.classList.remove('fact-transition');
          }, 700);
          
        }, 300);
      }

      // Initial fact + rotate every 30 seconds
      showRandomFact();
      setInterval(showRandomFact, 30000);
      
      // Click handler for next fact button
      document.querySelector('.next-fact-btn').addEventListener('click', showRandomFact);
      
      // Also show new fact when clicking anywhere on the bar
      document.querySelector('.fun-fact-bar').addEventListener('click', function(e) {
        if (!e.target.closest('.next-fact-btn')) {
          showRandomFact();
        }
      });
    </script>
    
    <div class="container">
        <h1>
            <i class="fas fa-recycle"></i>
            BinGo Dashboard
        </h1>
        
        <div id="bins-list">
            <div class="loading-container">
                <div class="loading-spinner"></div>
                <p>Loading bins data...</p>
            </div>
        </div>
        
        <p id="last-updated" class="last-updated"></p>
    </div>

    <!-- Floating History Button -->
    <a href="history.html" class="floating-history-btn">
        <i class="fas fa-chart-line"></i>
        <span>Trash Level History</span>
    </a>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyD4SndxF5ZZcZHUj6m1TXghyNRh2uN7AkU",
            authDomain: "bingo-b9b42.firebaseapp.com",
            projectId: "bingo-b9b42",
            storageBucket: "bingo-b9b42.appspot.com",
            messagingSenderId: "588496760146",
            appId: "1:588496760146:web:1a3751363269ce12b5de8b"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Update last fetched time
        function updateLastFetchedTime() {
            const now = new Date();
            document.getElementById('last-updated').textContent =
                `Last updated: ${now.toLocaleTimeString()}`;
        }

        // Load all trash bins
        function loadBins() {
            const binsList = document.getElementById('bins-list');
            
            db.collection("trash_bins").get().then((querySnapshot) => {
                if (querySnapshot.empty) {
                    binsList.innerHTML = '<div class="error"><i class="fas fa-info-circle"></i><p>No bins found in the system.</p></div>';
                    return;
                }

                binsList.innerHTML = '';
                
                querySnapshot.forEach((doc) => {
                    const bin = doc.data();
                    binsList.innerHTML += `
                        <div class="bin-card">
                            <h2 class="bin-id">
                                <i class="fas fa-trash-alt"></i>
                                Bin ID: ${doc.id}
                            </h2>
                            <p class="location">
                                <i class="fas fa-map-marker-alt"></i>
                                ${bin.location || 'Location not specified'}
                            </p>
                            <p class="trash-level">
                                <i class="fas fa-tachometer-alt"></i>
                                ${bin.trash_level || '0'}% full
                            </p>
                            <a href="bin.html?id=${doc.id}" class="view-link">
                                View details <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                    `;
                });
                
                updateLastFetchedTime();
            }).catch((error) => {
                console.error("Firebase error:", error);
                binsList.innerHTML = `
                    <div class="error">
                        <i class="fas fa-exclamation-triangle"></i>
                        <p>Failed to load data.</p>
                        <button onclick="window.location.reload()">
                            <i class="fas fa-sync-alt"></i> Retry
                        </button>
                    </div>
                `;
            });
        }

        // Initial load + auto-refresh every 30 seconds
        loadBins();
        setInterval(loadBins, 30000);
    </script>
</body>
</html>
